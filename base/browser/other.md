# 浏览器原理
> https://segmentfault.com/a/1190000012925872

##### 进程和线程
- 进程是CPU资源分配的最小单位(能拥有资源和独立运行的最小单位)，进程之间相互独立
- 线程是CPU调度的最小单位，一个进程由一个或多个线程组成，多个线程在进程中协作完成任务，同一进程下的各个线程之间共享程序的内存空间，类似火车和火车车厢的关系
- 单线程与多线程，都是指在一个进程内的单和多

##### 浏览器是多进程的
- 浏览器是多进程的，一般一个Tab对应一个进程(有时候也会合并进程)。
- 在浏览器中打开一个网页相当于新起了一个进程（进程内有自己的多线程）
- 浏览器的进程：
  - Browser进程：浏览器的主进程，负责Tab外的各种操作——前进、后退、下载等。
  - 第三方插件进程：每种类型的插件对应一个进程，仅当使用该插件时才创建
  - GPU进程：最多一个，用于3D绘制等
  - 浏览器渲染(浏览器内核，Renderer进程，内部多线程，)：每个Tab页面一个进程(有时候会合并)，互不影响。主要作用为：页面渲染，脚本执行，事件处理等

##### 浏览器内核（Renderer进程）
- 浏览器的渲染进程是多线程的，它包括
  - GUI渲染线程
    - 负责渲染/重绘/回流浏览器界面，解析HTML，CSS，构建DOM树，布局和绘制等。
    - !!!GUI渲染线程与JS引擎线程是互斥的，所以JS执行的时间过长，就会造成渲染加载阻塞。
  - JS引擎线程：如V8引擎，负责处理JS脚本，一个Tab页（renderer进程）中只有一个JS线程在运行JS程序
  - 事件触发线程：负责将异步事件对应的回调函数加入消息队列(异步任务队列)，以及将消息队列的任务(回调函数)加入执行栈
  - 定时触发器线程：setInterval与setTimeout所在的线程，用于计时，计时完成后由事件触发线程将回调函数加入到消息队列
  - 异步http请求线程：在XMLHttpRequest在连接后是通过浏览器新开一个线程请求，ajax返回后由事件触发线程将回调函数加入到消息队列

##### 网络部分
- URL解析
- DNS解析
- 建立TCP连接
- 浏览器发送请求
- 服务器接受请求并响应
- 断开TCP连接
- 页面渲染

##### 从浏览器接收url到开启网络请求线程
- 输入URL，Browser进程开启一个网络线程
- 网络线程进行http请求，然后等待响应，获取内容，随后将内容转交给Renderer进程
